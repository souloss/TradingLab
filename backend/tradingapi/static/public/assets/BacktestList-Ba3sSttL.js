import{j as e,h as w,r as i,a as b,T as S,I as v,J as C,L,b as T}from"./index-0_VxV31d.js";import{a as D}from"./table-CvEssuqL.js";import{C as E,a as I,b as K,c as q}from"./card-zQ26J-2A.js";import{B as u}from"./button-Bt7YHDly.js";import{I as $}from"./check-BbGLn5SG.js";import{g as B}from"./PaginatedTable-Bo70QTWH.js";import{c as F}from"./createLucideIcon-y7kU-Jnn.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=F("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);function z({className:a,...t}){return e.jsx("div",{className:w("animate-pulse rounded-md bg-muted",a),...t})}const p=10;async function J(a,t,c){return await T("GET",`/api/v1/backtest?page=${a}&pageSize=${t}&keyword=${c??""}`)}function V(){const[a,t]=i.useState(1),[c,l]=i.useState(""),[n,g]=i.useState(!0),[d,f]=i.useState(""),{data:r,isLoading:m,error:j,refetch:h,isFetching:y}=D({queryKey:["backtests",a,d],queryFn:()=>J(a,p,d),enabled:!n});i.useEffect(()=>{n&&(g(!1),h())},[n,h]);const x=()=>{t(1),f(c)},N=s=>{s.key==="Enter"&&x()};if(j)return e.jsx("div",{className:"text-red-500",children:"加载数据失败，请稍后重试"});const k=[{id:"stockCode",header:"股票代码",accessor:"stockCode",sortable:!0,className:"text-primary font-semibold"},{id:"stockName",header:"股票名称",accessor:"stockName",sortable:!0},{id:"strategy",header:"策略",cell:s=>e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-medium",children:s.strategy.name}),e.jsxs(S,{children:[e.jsx(v,{asChild:!0,children:e.jsx("div",{className:"text-xs text-muted-foreground truncate max-w-[200px] cursor-help",children:JSON.stringify(s.strategy.params)})}),e.jsx(C,{side:"top",className:"max-w-sm",children:e.jsx("pre",{className:"text-xs whitespace-pre-wrap",children:JSON.stringify(s.strategy.params,null,2)})})]})]})},{id:"dateRange",header:"日期范围",cell:s=>e.jsxs("span",{className:"text-sm text-muted-foreground",children:[new Date(s.start).toLocaleDateString()," -"," ",new Date(s.end).toLocaleDateString()]})},{id:"action",header:"操作",cell:s=>e.jsx(L,{href:`/results/${s.id}`,onClick:o=>{o.preventDefault(),i.startTransition(()=>{window.location.href=`/results/${s.id}`})},children:e.jsx(u,{variant:"outline",size:"sm",children:"查看结果"})})}];return e.jsxs("div",{className:"container mx-auto py-10 space-y-6",children:[e.jsx(b,{isVisible:m||y}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"历史回测记录"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{placeholder:"搜索股票或策略...",value:c,onChange:s=>l(s.target.value),onKeyDown:N,className:"w-64"}),e.jsxs(u,{onClick:x,children:[e.jsx(P,{className:"w-4 h-4 mr-1"})," 搜索"]})]})]}),e.jsxs(E,{className:"shadow-lg border rounded-2xl",children:[e.jsx(I,{className:"pb-4",children:e.jsx(K,{className:"text-lg font-semibold",children:"回测列表"})}),e.jsx(q,{children:m?e.jsx("div",{className:"space-y-3",children:[...Array(5)].map((s,o)=>e.jsx(z,{className:"h-10 w-full rounded-lg"},o))}):e.jsx(B,{columns:k,data:(r==null?void 0:r.items)??[],page:a,pageSize:p,totalItems:(r==null?void 0:r.total)??0,onPageChange:s=>{t(s)},rowKey:s=>s.id})})]})]})}export{V as default};
